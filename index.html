<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pop-up Document</title>
</head>

<body>
  <h1>Hello from pop-up</h1>
  <button onclick="instantClose()">Instant close</button>
  <button onclick="delayedCloseAsync()">Delayed close(async)</button>
  <br />
  <br />
  <textarea readonly id="output"></textarea>
</body>

<script>
  function instantClose() {
    const daddy = window.self;
    daddy.opener = window.self;
    daddy.close();
  }

  const wait = (time) => new Promise((resolve) => {
    setTimeout(resolve, time);
  })
  async function delayedCloseAsync() {
    document.getElementById('output').innerText = 'Waiting for 3 seconds'
    await wait(3000)
    document.getElementById('output').innerText = 'Closing..'

    const daddy = window.self;
    daddy.opener = window.self;
    daddy.close();
  }
</script>

</html>
